{"openapi":"3.0.0","info":{"version":"1.0.0","title":"Quota Management API server"},"paths":{"/quotas":{"get":{"parameters":[{"$ref":"#/components/parameters/PageParam"},{"$ref":"#/components/parameters/LimitParam"},{"$ref":"#/components/parameters/SortParam"},{"$ref":"#/components/parameters/CountByParam"},{"$ref":"#/components/parameters/NameParam"},{"$ref":"#/components/parameters/ParentIdParam"},{"$ref":"#/components/parameters/AncestorIdParam"},{"$ref":"#/components/parameters/DescendantIdParam"},{"$ref":"#/components/parameters/SumByParam"}],"responses":{"200":{"description":"quotas response","content":{"application/json":{"schema":{"oneOf":[{"$ref":"#/components/schemas/Quotas"},{"$ref":"#/components/schemas/CountResponse"},{"$ref":"#/components/schemas/SumResponse"}]}}}},"default":{"description":"unexpected error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}},"post":{"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewQuota"}}}},"responses":{"201":{"description":"quotas response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Quota"}}}}},"default":{"description":"unexpected error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/quotas/{id}":{"get":{"parameters":[{"$ref":"#/components/parameters/QuotaIdParam"}],"responses":{"200":{"description":"quota response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Quota"}}}}}},"patch":{"parameters":[{"$ref":"#/components/parameters/QuotaIdParam"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EditQuota"}}}},"responses":{"204":{"description":"quotas response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Quota"}}}}},"default":{"description":"unexpected error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}},"delete":{"parameters":[{"$ref":"#/components/parameters/QuotaIdParam"}],"responses":{"200":{"description":"success response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Success"}}}},"default":{"description":"unexpected errors","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/destinations":{"get":{"parameters":[{"$ref":"#/components/parameters/PageParam"},{"$ref":"#/components/parameters/LimitParam"},{"$ref":"#/components/parameters/SortParam"},{"$ref":"#/components/parameters/CountByParam"},{"$ref":"#/components/parameters/NameParam"}],"responses":{"200":{"description":"destinations response","content":{"application/json":{"schema":{"oneOf":[{"$ref":"#/components/schemas/Destination"},{"$ref":"#/components/schemas/CountResponse"}]}}}},"default":{"description":"unexpected errors","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}},"post":{"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewDestination"}}}},"responses":{"201":{"description":"destination response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Destination"}}}}},"default":{"description":"unexpected error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/destinations/{id}":{"get":{"parameters":[{"$ref":"#/components/parameters/DestinationIdParam"}],"responses":{"200":{"description":"destination response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Destination"}}}}}},"patch":{"parameters":[{"$ref":"#/components/parameters/DestinationIdParam"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewDestination"}}}},"responses":{"204":{"description":"destination response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Destination"}}}}},"default":{"description":"unexpected error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}},"delete":{"parameters":[{"$ref":"#/components/parameters/QuotaIdParam"}],"responses":{"200":{"description":"success response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Success"}}}},"default":{"description":"unexpected errors","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}}},"components":{"parameters":{"QuotaIdParam":{"in":"path","name":"id","required":true,"schema":{"type":"string","format":"UUID"},"description":"Id of quota"},"DestinationIdParam":{"in":"path","name":"id","required":true,"schema":{"type":"string","format":"UUID"},"description":"Id of destination"},"PageParam":{"in":"query","name":"page","required":false,"schema":{"type":"integer","default":1},"description":"Page number"},"LimitParam":{"in":"query","name":"limit","required":false,"schema":{"type":"integer","default":10}},"SortParam":{"in":"query","name":"sort","required":false,"schema":{"type":"string","default":"created_at desc"}},"CountByParam":{"in":"query","name":"countBy","required":false,"schema":{"type":"string"},"description":"Count by field"},"NameParam":{"in":"query","name":"name","required":false,"schema":{"type":"string","default":"all"},"description":"filter by name (starts with)"},"ParentIdParam":{"in":"query","name":"parentId","required":false,"schema":{"type":"string"},"description":"filter by quota parent id"},"AncestorIdParam":{"in":"query","name":"ancestorId","required":false,"schema":{"type":"string"},"description":"filter by quota ancestor id"},"DescendantIdParam":{"in":"query","name":"descendantId","required":false,"schema":{"type":"string"},"description":"filter by quota descendant id"},"SumByParam":{"in":"query","name":"sumBy","required":false,"schema":{"type":"string"},"description":"sum by specific field"}},"schemas":{"Error":{"type":"object","required":["error"],"properties":{"error":{"type":"string"}}},"Success":{"type":"object","required":["success"],"properties":{"success":{"type":"string"}}},"Quota":{"type":"object","properties":{"id":{"type":"string","format":"UUID"},"name":{"type":"string"},"telemetryType":{"type":"string","enum":["logs","metrics","traces"]},"volumeInGb":{"type":"number","format":"double"},"dailyUsageInGb":{"type":"number"},"policyId":{"type":"string","format":"UUID"},"createdById":{"type":"string"},"parentId":{"type":"string","format":"UUID"},"actions":{"type":"array","items":{"$ref":"#/components/schemas/QuotaAction"}},"createdAt":{"type":"string","format":"date-time"},"conditions":{"type":"array","items":{"oneOf":[{"$ref":"#/components/schemas/IsEmpty"},{"$ref":"#/components/schemas/EqualsOneOf"},{"$ref":"#/components/schemas/Equals"},{"$ref":"#/components/schemas/Contains"},{"$ref":"#/components/schemas/Regex"}],"discriminator":{"propertyName":"operator","mapping":{"IsEmpty":"IsEmpty","EqualsOneOf":"EqualsOneOf","Equals":"Equals","Contains":"Contains","Regex":"Regex"}}}},"updatedAt":{"type":"string","format":"date-time"},"deletedAt":{"type":"string","format":"date-time"},"breachedAt":{"type":"string","format":"date-time"},"isActive":{"type":"boolean"}}},"Quotas":{"type":"array","items":{"$ref":"#/components/schemas/Quota"}},"Pipeline":{"type":"object","required":["id"],"properties":{"id":{"type":"string","format":"UUID"}}},"QuotaPolicy":{"type":"object","properties":{"id":{"type":"string","format":"UUID"},"name":{"type":"string"},"volumeInGb":{"type":"number","format":"double"},"dailyUsageInGb":{"type":"number"},"policyId":{"type":"string","format":"UUID"},"conditions":{"type":"array","items":{"oneOf":[{"$ref":"#/components/schemas/IsEmpty"},{"$ref":"#/components/schemas/EqualsOneOf"},{"$ref":"#/components/schemas/Equals"},{"$ref":"#/components/schemas/Contains"},{"$ref":"#/components/schemas/Regex"}],"discriminator":{"propertyName":"operator","mapping":{"IsEmpty":"IsEmpty","EqualsOneOf":"EqualsOneOf","Equals":"Equals","Contains":"Contains","Regex":"Regex"}}}},"actions":{"type":"array","items":{"$ref":"#/components/schemas/QuotaAction"}},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"deletedAt":{"type":"string","format":"date-time"},"breachedAt":{"type":"string","format":"date-time"},"isActive":{"type":"boolean"}}},"NewQuota":{"type":"object","required":["name","volumeInGb","conditions","telemetryType"],"properties":{"name":{"type":"string"},"volumeInGb":{"type":"number","format":"double"},"parentId":{"type":"string","format":"UUID"},"telemetryType":{"$ref":"#/components/schemas/TelemetryType"},"conditions":{"type":"array","items":{"oneOf":[{"$ref":"#/components/schemas/IsEmpty"},{"$ref":"#/components/schemas/EqualsOneOf"},{"$ref":"#/components/schemas/Equals"},{"$ref":"#/components/schemas/Contains"},{"$ref":"#/components/schemas/Regex"}],"discriminator":{"propertyName":"operator"}}},"actions":{"type":"array","items":{"$ref":"#/components/schemas/QuotaAction"}},"isActive":{"type":"boolean"}}},"EditQuota":{"type":"object","additionalProperties":false,"properties":{"name":{"type":"string"},"isActive":{"type":"boolean"},"volumeInGb":{"type":"number","format":"double"},"parentId":{"type":"string","format":"UUID"},"telemetryType":{"$ref":"#/components/schemas/TelemetryType"},"conditions":{"type":"array","items":{"oneOf":[{"$ref":"#/components/schemas/IsEmpty"},{"$ref":"#/components/schemas/EqualsOneOf"},{"$ref":"#/components/schemas/Equals"},{"$ref":"#/components/schemas/Contains"},{"$ref":"#/components/schemas/Regex"}],"discriminator":{"propertyName":"operator","mapping":{"IsEmpty":"IsEmpty","EqualsOneOf":"EqualsOneOf","Equals":"Equals","Contains":"Contains","Regex":"Regex"}}}},"actions":{"type":"array","items":{"$ref":"#/components/schemas/QuotaAction"}}}},"ActionType":{"type":"string","enum":["drop","notify","sample"]},"QuotaAction":{"type":"object","required":["type"],"additionalProperties":false,"properties":{"type":{"$ref":"#/components/schemas/ActionType"},"data":{"type":"object"},"percentageLevel":{"type":"number"}}},"BinarySingleValueCondition":{"type":"object","additionalProperties":false,"required":["attribute","operator","value"],"properties":{"attribute":{"type":"string"},"operator":{"type":"string","enum":["Equals","Contains","Regex"]},"value":{"type":"string"}}},"Equals":{"allOf":[{"$ref":"#/components/schemas/BinarySingleValueCondition"}]},"Contains":{"allOf":[{"$ref":"#/components/schemas/BinarySingleValueCondition"}]},"Regex":{"allOf":[{"$ref":"#/components/schemas/BinarySingleValueCondition"}]},"EqualsOneOf":{"type":"object","additionalProperties":false,"required":["attribute","operator","values"],"properties":{"attribute":{"type":"string"},"operator":{"type":"string","enum":["EqualsOneOf"]},"values":{"type":"array","items":{"type":"string"}}}},"IsEmpty":{"type":"object","additionalProperties":false,"required":["attribute","operator"],"properties":{"attribute":{"type":"string"},"operator":{"type":"string","enum":["IsEmpty"]}}},"Destination":{"type":"object","required":["id"],"additionalProperties":false,"properties":{"id":{"type":"string","format":"UUID"},"name":{"type":"string"},"type":{"type":"string"},"isActive":{"type":"boolean"}}},"NewDestination":{"type":"object","required":["name","type"],"additionalProperties":false,"properties":{"name":{"type":"string"},"type":{"type":"string"},"isActive":{"type":"boolean"}}},"CountResponse":{"type":"array","items":{"$ref":"#/components/schemas/CountById"}},"CountById":{"type":"object","required":["id"],"properties":{"id":{"type":"integer"}}},"SumResponse":{"type":"array","items":{"$ref":"#/components/schemas/SumByVolumeInGB"}},"SumByVolumeInGB":{"type":"object","required":["volumeInGb"],"properties":{"volumeInGb":{"type":"number","format":"double"}}},"TelemetryType":{"type":"string","enum":["logs","metrics","traces"]}}},"x-readme":{"explorer-enabled":true,"proxy-enabled":true}}